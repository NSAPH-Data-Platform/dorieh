<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dorieh Core Data Platform &mdash; Dorieh Data Platform 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_paramlinks.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/dorieh.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Modelling for Dorieh Data Platform" href="Datamodels.html" />
    <link rel="prev" title="Data Platform Internals" href="guts.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Dorieh Data Platform
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="home.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="rationale.html">What is Data Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="domains.html">Data Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">Data Processing Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="packages.html">Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="guts.html">Data Platform Internals</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Dorieh Core Data Platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Datamodels.html">Data Modelling for Dorieh Data Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="DBConnections.html">Managing database connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="DataLoader.html">Dorieh Data Loader</a></li>
<li class="toctree-l3"><a class="reference internal" href="ProjectLoader.html">Project (Directory) Loading Utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="TerritorialCodes.html">Mapping between different territorial codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="SampleQuery.html">How to query the database</a></li>
<li class="toctree-l3"><a class="reference internal" href="UserRequests.html">Preliminary Considerations for Handling User Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="SQLDocumentation.html">SQL Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-platform-overview">Core platform overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tool-examples">Tool Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#project-structure">Project Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#software-sources">Software Sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-packages">Python packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sql-utilities">SQL Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#territorial-codes-mappings">Territorial Codes Mappings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#documentation-indices">Documentation Indices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html">Dorieh Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="DBConnections.html">Managing database connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="ProjectLoader.html">Project (Directory) Loading Utility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DBT.html">Database Testing Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_data.html">Adding more data</a></li>
<li class="toctree-l1"><a class="reference internal" href="AppPipelineGenerator.html">Executing containerized apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms and Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="docindices.html">Indices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Dorieh Data Platform</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="guts.html">Data Platform Internals</a></li>
      <li class="breadcrumb-item active">Dorieh Core Data Platform</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/platform.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dorieh-core-data-platform">
<h1>Dorieh Core Data Platform<a class="headerlink" href="#dorieh-core-data-platform" title="Permalink to this heading"></a></h1>
<p><a class="reference internal" href="home.html"><span class="doc std std-doc">Documentation Home</span></a></p>
<div class="toctree-wrapper compound">
</div>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#core-platform-overview" id="id1">Core platform overview</a></p></li>
<li><p><a class="reference internal" href="#tool-examples" id="id2">Tool Examples</a></p></li>
<li><p><a class="reference internal" href="#project-structure" id="id3">Project Structure</a></p>
<ul>
<li><p><a class="reference internal" href="#software-sources" id="id4">Software Sources</a></p></li>
<li><p><a class="reference internal" href="#python-packages" id="id5">Python packages</a></p></li>
<li><p><a class="reference internal" href="#resources" id="id6">Resources</a></p></li>
<li><p><a class="reference internal" href="#sql-utilities" id="id7">SQL Utilities</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#territorial-codes-mappings" id="id8">Territorial Codes Mappings</a></p></li>
<li><p><a class="reference internal" href="#documentation-indices" id="id9">Documentation Indices</a></p></li>
</ul>
</nav>
<section id="core-platform-overview">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Core platform overview</a><a class="headerlink" href="#core-platform-overview" title="Permalink to this heading"></a></h2>
<p>The data platform provides generic functionality for Dorieh Data Platform
with APIs and command line utilities dependent on the infrastructure
and the environment. For instance, its components assume presence of PostgreSQL
DBMS (version 13 or later) and CWL runtime environment.</p>
<p>Some mapping (or crosswalk) tables are also included in the Core
Platform module. These tables include between different
territorial codes, such as USPS ZIP codes, Census ZCTA codes,
FIPS codes for US states
and counties, SSA codes for US states
and counties. See more information in the
<a class="reference external" href="https://nsaph-data-platform.github.io/nsaph-platform-docs/common/core-platform/doc/TerritorialCodes.html">Mapping between different territorial codes</a></p>
<p>See also: <a class="reference internal" href="DBConnections.html"><span class="doc std std-doc">Managing database connections</span></a>.</p>
</section>
<section id="tool-examples">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Tool Examples</a><a class="headerlink" href="#tool-examples" title="Permalink to this heading"></a></h2>
<p>Examples of tools included in this package are:</p>
<ul class="simple">
<li><p><a class="reference internal" href="members/data_loader.html"><span class="doc std std-doc">Universal Data Loader</span></a></p></li>
<li><p>A <a class="reference internal" href="MonitoringDB.html"><span class="doc std std-doc">utility to monitor progress of long-running database</span></a> processes like indexing.</p></li>
<li><p>A <a class="reference internal" href="members/introspector.html"><span class="doc std std-doc">utility to infer database schema and generate DDL</span></a> from a CSV file</p></li>
<li><p>A <a class="reference internal" href="members/link_gis.html"><span class="doc std std-doc">utility to link a table to GIS</span></a> from a CSV file</p></li>
<li><p>A <a class="reference internal" href="members/db.html"><span class="doc std std-doc">wrapper around database connection to PostgreSQL</span></a></p></li>
<li><p>A <a class="reference internal" href="members/pg_json_dump.html"><span class="doc std std-doc">utility to import/export JSONLines</span></a> files into/from PostgreSQL</p></li>
<li><p>A <a class="reference internal" href="members/pg_export_parquet.html"><span class="doc std std-doc">utility to export Parquet files</span></a> files from PostgreSQL</p></li>
<li><p>An <a class="reference internal" href="members/executors.html"><span class="doc std std-doc">Executor with a bounded queue</span></a></p></li>
</ul>
</section>
<section id="project-structure">
<span id="core-prj-struct"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Project Structure</a><a class="headerlink" href="#project-structure" title="Permalink to this heading"></a></h2>
<p><strong>The package is under intensive development, the project structure is in flux</strong></p>
<p>Top level directories are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- doc
- resources
- src
- examples
- docker
</pre></div>
</div>
<p>Doc directory contains documentation.</p>
<p>Resource directory contains resources that must be loaded in
the data platform for its normal functioning. For example,
they contain mappings between US states, counties, fips and zip codes.
See details in <a class="reference internal" href="#resources">Resources</a> section.</p>
<p>Src directory contains software source code.
See details in <a class="reference internal" href="#core-software-sources"><span class="std std-ref">Software Sources</span></a> section.</p>
<section id="software-sources">
<span id="core-software-sources"></span><h3><a class="toc-backref" href="#id4" role="doc-backlink">Software Sources</a><a class="headerlink" href="#software-sources" title="Permalink to this heading"></a></h3>
<p>The directories under sources are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- cwl
- python
- sql
</pre></div>
</div>
<p>They are described in more details in the corresponding sections.
Here is a brief overview:</p>
<ul class="simple">
<li><p><strong>cwl</strong> contains reusable workflows, packaged as tools
that can and should be used by
Dorieh pipelines. Examples of such tools
are: introspection of CSV files, indexing tables, linking
tables with GIS information for easy mapping, creation of a
Superset datasource.</p></li>
<li><p><strong>sql</strong> contains PostgreSQL procedures and functions
implemented in the PostgreSQL dialect of SQL/DDL and PL/pgSQL language</p></li>
<li><p><strong>python</strong> contains Python code. See <a class="reference internal" href="#python-packages">more details</a>.</p></li>
</ul>
</section>
<section id="python-packages">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Python packages</a><a class="headerlink" href="#python-packages" title="Permalink to this heading"></a></h3>
<p>Modules and subpackages included in <code class="docutils literal notranslate"><span class="pre">dorieh.platform</span></code> package are
described <a class="reference internal" href="CoreLibrary.html"><span class="std std-doc">here</span></a>.</p>
</section>
<section id="resources">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Resources</a><a class="headerlink" href="#resources" title="Permalink to this heading"></a></h3>
<p>Resources are organized in the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- ${database schema}/
    - ddl file for ${resource1}
    - content of ${resource1} in JSON Lines format (*.json.gz)
    - ddl file for ${resource2}
    - content of ${resource2} in JSON Lines format (*.json.gz)
</pre></div>
</div>
<p>Resources can be packaged when a
<a class="reference external" href="https://pythonwheels.com/">wheel</a>
is built. Support for packaging resources during development and
after a package is deployed is provided by
<a class="reference internal" href="members/resources.html"><span class="doc std std-doc">resources</span></a> module.</p>
<p>Another module, <a class="reference internal" href="members/pg_json_dump.html"><span class="doc std std-doc">pg_json_dump</span></a>,
provides support for packaging tables as resources in JSONLines
format. This format is used natively by some DBMSs.</p>
</section>
<section id="sql-utilities">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">SQL Utilities</a><a class="headerlink" href="#sql-utilities" title="Permalink to this heading"></a></h3>
<p>Utilities, implementing the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="members/utils.sql.html"><span class="doc std std-doc">Functions</span></a>:</p>
<ul>
<li><p>Counting rows in tables</p></li>
<li><p>Finding a name of the column that contains year from most tables used in data platform</p></li>
<li><p>Creating a hash for <a class="reference external" href="https://en.wikipedia.org/wiki/HyperLogLog">HLL aggregations</a></p></li>
</ul>
</li>
<li><p>Procedure:</p>
<ul>
<li><p><a class="reference internal" href="members/utils.sql.html"><span class="doc std std-doc">A procedure</span></a> granting <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> privileges
to a user on all tables created or managed by Dorieh platform</p>
<ul>
<li><p><a class="reference internal" href="members/rename_indices.sql.html"><span class="doc std std-doc">A procedure to rename indices</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p>Set of SQL statements:
<a class="reference internal" href="members/map_to_foreign_database.ddl.html"><span class="doc std std-doc">to map tables from another database</span></a>
This can be used to map public tables available to anybody
to a more secure database, containing health data</p></li>
<li><p><a class="reference internal" href="members/zip2fips.sql.html"><span class="doc std std-doc">Tables and functions</span></a> to
<a class="reference internal" href="#territorial-codes-mappings">map between different territorial codes</a>,
including USPS ZIP codes, Census ZCTA codes,
FIPS codes for US states
and counties, SSA codes for codes for US states
and counties.</p></li>
</ul>
</section>
</section>
<section id="territorial-codes-mappings">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Territorial Codes Mappings</a><a class="headerlink" href="#territorial-codes-mappings" title="Permalink to this heading"></a></h2>
<p>An important part of the data platform is the mappings between different
territorial codes, such as USPS ZIP codes, Census ZCTA codes,
FIPS codes for US states and counties, SSA codes for codes for US states
and counties. See more information in the
<a class="reference internal" href="TerritorialCodes.html"><span class="doc std std-doc">Mapping between different territorial codes</span></a>
page.</p>
</section>
<section id="documentation-indices">
<span id="core-soft-idx"></span><h2><a class="toc-backref" href="#id9" role="doc-backlink">Documentation Indices</a><a class="headerlink" href="#documentation-indices" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">genindex</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">modindex</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="guts.html" class="btn btn-neutral float-left" title="Data Platform Internals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Datamodels.html" class="btn btn-neutral float-right" title="Data Modelling for Dorieh Data Platform" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024, Harvard University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>